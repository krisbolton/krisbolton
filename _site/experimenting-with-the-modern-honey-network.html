<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
        <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Experimenting with the Modern Honeypot Network (MHN) | Kris Bolton</title>
<meta name="generator" content="Jekyll v3.6.3" />
<meta property="og:title" content="Experimenting with the Modern Honeypot Network (MHN)" />
<meta name="author" content="Kris Bolton" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="MHN is an open-source centralized server for managing honeypots, making deployment and data collection simple and fast. MHN currently supports a number of honeypot types, check out the list of supported sensors for details, they also allow adding new sensors should you wish." />
<meta property="og:description" content="MHN is an open-source centralized server for managing honeypots, making deployment and data collection simple and fast. MHN currently supports a number of honeypot types, check out the list of supported sensors for details, they also allow adding new sensors should you wish." />
<link rel="canonical" href="http://localhost:4000/experimenting-with-the-modern-honey-network" />
<meta property="og:url" content="http://localhost:4000/experimenting-with-the-modern-honey-network" />
<meta property="og:site_name" content="Kris Bolton" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-04-22T00:00:00+01:00" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@" />
<meta name="twitter:creator" content="@Kris Bolton" />
<script type="application/ld+json">
{"datePublished":"2020-04-22T00:00:00+01:00","headline":"Experimenting with the Modern Honeypot Network (MHN)","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/experimenting-with-the-modern-honey-network"},"url":"http://localhost:4000/experimenting-with-the-modern-honey-network","author":{"@type":"Person","name":"Kris Bolton"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"http://localhost:4000/assets/images/logo.png"},"name":"Kris Bolton"},"description":"MHN is an open-source centralized server for managing honeypots, making deployment and data collection simple and fast. MHN currently supports a number of honeypot types, check out the list of supported sensors for details, they also allow adding new sensors should you wish.","@type":"BlogPosting","dateModified":"2020-04-22T00:00:00+01:00","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->

    

    <!-- Site Favicon -->
    <link rel="shortcut icon" href="http://localhost:4000/assets/images/favicon.ico" type="image/png" />

    <!-- Font Embed Code -->
    <link href="https://fonts.googleapis.com/css?family=Karla:400,400i,700,700i" rel="stylesheet" />

    <!-- CSS Styles -->
    <link href="/assets/css/style.css" rel="stylesheet">

</head>



<body class="layout-post">
    <div id="page" class="site">

        
        <header id="masthead" class="site-header outer">
    <div class="site-header-inside">
        <div class="site-branding">
            
                <p class="site-logo"><a href="/" rel="home"><img src="/assets/images/logo.png" alt="Kris Bolton" /></a></p>
                <h1 class="site-title screen-reader-text"><a href="" rel="home"></a></h1>
            
        </div><!-- .site-branding -->
        <nav id="main-navigation" class="site-navigation" aria-label="Primary Navigation">
            <ul class="menu">
            
                <li class="menu-item"><a href="/">Home</a></li>
            
                <li class="menu-item"><a href="/about.html">About</a></li>
            
                <li class="menu-item"><a href="/contact.html">Contact</a></li>
            
            </ul>
            <button id="sidebar-show" class="sidebar-toggle"><span class="screen-reader-text">Open Sidebar</span><span class="icon-more" aria-hidden="true"></span></button>
        </nav><!-- .site-navigation -->
    </div><!-- .site-header-inside -->
</header><!-- .site-header -->
        

        <div id="content" class="site-content fadeInDown delay_075s">
    <main id="main" class="site-main outer">
        <article class="post-full inner">
            <header class="post-header">
                <div class="post-meta">
                    <time class="post-date" datetime="2020-04-22">April 22,
                        2020</time>
                </div><!-- .post-meta -->
                <h1 class="posttitle">Experimenting with the Modern Honeypot Network (MHN)</h1>
            </header><!-- .post-header -->
            
            <div class="post-thumbnail"><img class="featured-image img-fluid" src="assets/images/posts/2020/honeypot-map.png"
                    alt="Experimenting with the Modern Honeypot Network (MHN)"></div>
            
            <div class="post-content">
                <p><a href="https://github.com/pwnlandia/mhn">MHN</a> is an open-source centralized server for managing honeypots, making deployment and data collection simple and fast. MHN currently supports a number of honeypot types, check out the <a href="https://github.com/pwnlandia/mhn/wiki/List-of-Supported-Sensors">list of supported sensors</a> for details, they also allow <a href="https://github.com/pwnlandia/mhn/wiki/Add-Support-for-New-Sensors-to-the-MHN">adding new sensors</a> should you wish.</p>

<!--more-->

<h3 id="setup">Setup</h3>
<p>My goal was to collect malware and aggregate statistics on various connections and attacks against a single sensor server I deployed. The architecture was two nano linode ubuntu 16.04 instances, one acting as the server and the other as the sensor. This turned out well, the nano instance was enough to handle the workload the majority of the time.</p>

<h4 id="server-setup">Server setup</h4>

<p>Find a server provider, I chose <a href="https://www.linode.com/">Linode</a>. I went with the nano configuration; 1GB RAM, 1CPU, 25GB storage, 1TB bandwidth for $5 per month. Enough for a small setup, as you add sensors the server will need more resources, so provision accordingly.</p>

<p>Give your server a discriptive name, e.g. “mhn-server”. Ubuntu 16.04 is recommended by MHN as its been tested and verified to work with MHN.</p>

<p>Secure the mhn-server as your normally would, its intended for you to manage sensors, you’re not looking for attackers to attack this instance.</p>

<h4 id="server-steps">Server steps</h4>

<h6 id="create-a-non-root-user">Create a non-root user.</h6>

<p><code class="highlighter-rouge">adduser deploy</code></p>

<p>Don’t install MHN as root, it will not work as intended.</p>

<h6 id="add-deploy-as-sudo-user-under-user-privilage-specification">Add deploy as sudo user under ‘user privilage specification’:</h6>

<p><code class="highlighter-rouge">visudo</code>
<code class="highlighter-rouge">deploy ALL=(ALL:ALL) ALL</code></p>

<h6 id="switch-to-the-deploy-user">Switch to the deploy user:</h6>

<p><code class="highlighter-rouge">su deploy</code></p>

<h6 id="clone-the-mhn-github-repo">Clone the MHN GitHub repo:</h6>

<p><code class="highlighter-rouge">git clone https://github.com/pwnlandia/mhn.git</code></p>

<h6 id="change-to-the-mhn-directory">Change to the mhn directory:</h6>

<p><code class="highlighter-rouge">cd mhn</code></p>

<h6 id="run-the-installation-script">Run the installation script:</h6>

<p><code class="highlighter-rouge">sudo ./install.sh</code></p>

<p>Towards the end of the installation you’ll be asked a series of questions. I chose no debug mode, I added a new gmail I created - <strong>this will also be used to login to the web interface</strong>. I didn’t need splunk or ELK. I left the rest of the options as default.</p>

<h6 id="login-to-the-web-interface">Login to the web interface.</h6>

<p><code class="highlighter-rouge">ipconfig</code></p>

<p>Copy &amp; paste the IP into a browser on your machine, and login with the email and password you provided earlier.</p>

<p><em>The server’s done!</em></p>

<h4 id="sensor-setup">Sensor setup</h4>

<p>Create a second instance on your service provider, again using a descriptive name - this helps if you scale things up later. I went with ‘mhn-snort-dionaea’.</p>

<p>Snort is an intrusion detection system (IDS), which will provide detail on attacks against the server. It can be configurted extensively, see the <a href="https://www.snort.org/documents">snort documentation</a> for more.</p>

<p>Dionaea is a a honeypot emulating various network services to capture malware. See the <a href="https://dionaea.readthedocs.io/en/latest/">dionaea documentation</a> for specific confifuration details.</p>

<h4 id="sensor-steps">Sensor steps</h4>

<h6 id="select-a-script">Select a script</h6>

<p>In the web interface provided by the mhn-server, go to the deploy tab and chose the sensor you want to deploy from the ‘select script’ drop down menu.</p>

<h6 id="copy--paste-wget-string">Copy &amp; paste wget string</h6>

<p>Sensor stepup is as easy as copy &amp; pasting the <code class="highlighter-rouge">wget</code> command string into the sensor instance.</p>

<h6 id="check-the-sensors-tab">Check the sensors tab</h6>

<p>Click the sensors tab in the web interface to view your new sensor.</p>

<h6 id="dionaea">Dionaea</h6>

<p>Follow the same steps copy &amp; pasting the <code class="highlighter-rouge">wget</code> script string for dionaea into the mhn-snort-dionaea instance.</p>

<p>Now you have snort and dionaea setup and running. You can view incoming attacks in the web interface.</p>

<h3 id="collecting-data">Collecting data</h3>

<p>As mentioned towards the beginning, my intention was to gather aggregate statistics and hopefully some malware files. Your goals may be different and you can add different sensors and service configurations to achieve your goals.</p>

<p>Immidiately I saw a small number of attacks coming in, surprising how quickly your services are found.</p>

<p>Within 24 hours I had logged over <em>300,000</em> scans and attacks from across the world. The web interface provides an enticing global attack map (below). The yellow dot shows the location of the server and the red dots show attacker locations.</p>

<p><img src="assets/images/posts/2020/honeypot-map.png" alt="" /></p>

<p>The sensor CPU handled the incoming traffic well, utilising around 40% max (observed). As scans/attacks increase between approx. 08:00 and 11:50 I turn on <code class="highlighter-rouge">ufw</code>, the linux firewall, to observe the effect out of interest. This is why the graph shows connections and CPU suddenly drop.</p>

<p><img src="assets/images/posts/2020/cpuhoneypot.png" alt="" /></p>

<p><img src="assets/images/posts/2020/traffichoneypot.png" alt="" /></p>

<p>Later I turned the firewall off and resumed data collection.</p>

<p>I’m planning on putting together a more detailed post of the data I captured. It won’t be anything particularly special, mostly data on which ports were most attacked, perhaps hints at attack behaviour. Dionaea did capture some files, but I’ve yet to take a look.</p>

<p>Look out for the details and lessons learned in an up-coming post.</p>

<h4 id="reminder">Reminder</h4>

<p>Whenever you do anything with malware consider the legal implications. Here you are collecting malware - likely a legal activity within your country. However, this quickly changes should you distribute it. Setting the server to be publicly available so you can download the malware, for example. To be clear, this is not legal advice, I am not a legal expert. As ever, seek advice specific to your location and proceed with caution.</p>

            </div>
            <footer class="post-footer">
                
                <p class="post-tags">
                     
                    <a href='tag/security/'>Security</a>
                    
                     
                    <a href='tag/honeypots/'>Honeypots</a>
                    
                    
                </p>
                
                <div class="post-share">
                    <span class="post-share-title">Share:</span>
                    <a target="_blank" href="https://twitter.com/share?text=Experimenting+with+the+Modern+Honeypot+Network+%28MHN%29&amp;url=experimenting-with-the-modern-honey-network">Twitter</a>
                    <a target="_blank" href="https://www.facebook.com/sharer/sharer.php?u=experimenting-with-the-modern-honey-network">Facebook</a>
                </div><!-- .share-post -->
            </footer>
            <div class="author-box">
                <div class="author-avatar"><img src="/assets/images/authorimage.jpg" alt="Kris Bolton's Picture"
                        class="avatar"></div>
                <div class="author-details">
                    <h2 class="author-title">About Kris Bolton</h2>
                    <p class="author-description">Kris is a cyber security masters student with a background in computer science (BSc software engineering), his research areas include Advanced Persistent Threats (APTs), Critical National Infrastructure (CNI) defense and machine learning.</p>
                </div>
            </div>
            

        </article>

        <section class="read-next inner">
            <h2 class="read-next-title">Read Next</h2>
            
            <article class="post">
                <header class="post-header">
                    <div class="post-meta">
                        <time class="published" datetime="March 10, 2019">March 10, 2019</time>
                    </div>
                    <h3 class="post-title"><a href="/uk-cyber-security-spending">UK Cyber Security Spending First Results: National Ambulance Services</a></h3>
                    <p class="post-tags">
                        
                        
                        
                        <a href='/tag/projects/'>Projects</a>
                        
                        
                        
                    </p>
                </header>
                
                <a href="/uk-cyber-security-spending" class="post-thumbnail">
                    <img src="assets/images/posts/2018/laptop-cash.jpg" alt="UK Cyber Security Spending First Results: National Ambulance Services" />
                </a>
                
            </article>
            
            
        </section><!-- .read-next -->
    </main><!-- .site-main -->
</div><!-- .site-content -->

        

        <footer id="colophon" class="site-footer outer">
            <div class="site-footer-inside">
                <p class="social-links">
    
    <a href="https://twitter.com/krisbolton" target="_blank">
        <span class="fa-twitter fa" aria-hidden="true"></span>
        <span class="screen-reader-text">Twitter</span>
    </a>
    
    
    
    <a href="https://github.com/krisbolton" target="_blank">
        <span class="fa-github fa" aria-hidden="true"></span>
        <span class="screen-reader-text">GitHub</span>
    </a>
    
    
    
    
    <a href="https://medium.com/@krisbolton" target="_blank">
        <span class="fa-medium fa" aria-hidden="true"></span>
        <span class="screen-reader-text">medium</span>
    </a>
    
    
    
    
    <a href="https://www.linkedin.com/in/krisbolton" target="_blank">
        <span class="fa-linkedin fa" aria-hidden="true"></span>
        <span class="screen-reader-text">Linkedin</span>
    </a>
    
    
</p>
                <p class="site-info">
                    <a href="#">Kris Bolton</a> &copy; 2020 . Horace theme by
                    <a target="_blank" href="https://justgoodthemes.com/">JustGoodThemes</a>. <br />
                    Powered by <a target="_blank" href="https://jekyllrb.com/">Jekyll</a> and <a target="_blank" href="https://pages.github.com/">GitHub Pages</a>. <br />
                    <a target="_blank" href="/privacy-policy.html">Privacy Policy</a>.
                </p>
                <p class="back-to-top">
                    <a id="top-button" class="top-button" href="#page">
                        <span class="icon-arrow-up" aria-hidden="true"></span>
                        <span class="screen-reader-text">Back to top</span>
                    </a>
                </p>
            </div><!-- .site-footer-inside -->
        </footer><!-- .site-footer -->
    </div><!-- .site -->
    <div id="site-overlay" class="site-overlay"></div>
    <aside id="sidebar" class="sidebar">
	<div class="sidebar-scrollable">
		<div class="sidebar-inside">
			<button id="sidebar-hide" class="sidebar-toggle"><span class="screen-reader-text">Close Sidebar</span><span
				    aria-hidden="true" class="icon-close"></span></button>
			<nav id="sidebar-navigation" class="widget site-navigation">
				<h2 class="widget-title">Explore Site</h2>
				<ul class="menu">
					
						<li class="menu-item"><a href="/">Home</a></li>
					
						<li class="menu-item"><a href="/about.html">About</a></li>
					
						<li class="menu-item"><a href="/contact.html">Contact</a></li>
					
				</ul>
			</nav>
			
<section class="widget widget-text">
    <h2 class="widget-title">About Kris Bolton</h2>
    <p>The personal website of Kris Bolton, Cyber Security Research Student.</p>
</section>


<section class="widget widget-recent-posts">
    <h2 class="widget-title">Recent Articles</h2>
    <ul>
        
        <li>
            <div class="post-header">
                <div class="post-meta">
                    <time class="published" datetime="??">April 22, 2020</time>
                </div>
                <div class="post-title">
                    <a href="http://localhost:4000/experimenting-with-the-modern-honey-network">Experimenting with the Modern Honeypot Network (MHN)</a>
                </div>
            </div>
            
            <a class="post-thumbnail" href="/experimenting-with-the-modern-honey-network">
                <img src="http://localhost:4000/assets/images/posts/2020/honeypot-map.png"
                    alt="Experimenting with the Modern Honeypot Network (MHN)">
            </a>
            
        </li>
        
        <li>
            <div class="post-header">
                <div class="post-meta">
                    <time class="published" datetime="??">March 10, 2019</time>
                </div>
                <div class="post-title">
                    <a href="http://localhost:4000/uk-cyber-security-spending">UK Cyber Security Spending First Results: National Ambulance Services</a>
                </div>
            </div>
            
            <a class="post-thumbnail" href="/uk-cyber-security-spending">
                <img src="http://localhost:4000/assets/images/posts/2018/laptop-cash.jpg"
                    alt="UK Cyber Security Spending First Results: National Ambulance Services">
            </a>
            
        </li>
        
        <li>
            <div class="post-header">
                <div class="post-meta">
                    <time class="published" datetime="??">August 22, 2018</time>
                </div>
                <div class="post-title">
                    <a href="http://localhost:4000/a-practical-introduction-to-artificial-neural-networks-with-python">A Practical Introduction to Artificial Neural Networks with Python</a>
                </div>
            </div>
            
            <a class="post-thumbnail" href="/a-practical-introduction-to-artificial-neural-networks-with-python">
                <img src="http://localhost:4000/assets/images/posts/2018/biasneuronexample.jpg"
                    alt="A Practical Introduction to Artificial Neural Networks with Python">
            </a>
            
        </li>
        
    </ul>
</section>

<!-- Create a sorted array of tags -->
 
<section class="widget widget-tagcloud">
    <h2 class="widget-title">Tags</h2>
    <div class="tagcloud">
        
        <a href='tag/books/'>Books</a>
        
        <a href='tag/honeypots/'>Honeypots</a>
        
        <a href='tag/machine- learning/'>Machine Learning</a>
        
        <a href='tag/neural- networks/'>Neural Networks</a>
        
        <a href='tag/projects/'>Projects</a>
        
        <a href='tag/reviews/'>Reviews</a>
        
        <a href='tag/security/'>Security</a>
        
        <a href='tag/sentiment- analysis/'>Sentiment Analysis</a>
        
    </div>
</section>


<section class="widget widget-newsletter">
    <div class="inner">
        <h2 class="widget-title">Subscribe to Kris Bolton</h2>
        <p>Get the latest and greatest from Kris Bolton delivered straight to your inbox every week.</p>
        <!-- Begin MailChimp Signup Form -->
        <div id="mc_embed_signup">
            <form action="https://krisbolton.us12.list-manage.com/subscribe/post?u=f493e5bbda4cf62b8809b4b61&amp;id=798a6931cc" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form"
                class="validate gh-subscribe-form" target="_blank" novalidate>
                <label for="mce-EMAIL" class="screen-reader-text">Email Address</label>
                <input type="email" value="" name="EMAIL" class="required email subscribe-email" id="mce-EMAIL"
                    placeholder="Your email address">
                <input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button">
            </form>
        </div>
    </div>
</section>

		</div><!-- .sidebar-inside -->
	</div><!-- .sidebar-scrollable -->
</aside><!-- .sidebar -->
    
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-781038-17"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-781038-17', { 'anonymize_ip': true });
  </script>

    <!-- Javascript Assets -->
    <script src="/assets/js/jquery-3.3.1.min.js"></script>
    <script src="/assets/js/plugins.js"></script>
    <script src="/assets/js/custom.js"></script>

</body>

</html>